<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<link rel="stylesheet" href="../../../css/fontello.css">
<link rel="stylesheet" href="../../../css/animation.css">

<!-- Mirrored from phocean.net/author/jc/page/16 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 May 2019 08:00:46 GMT -->
<!-- Mirrored from phocean.net/author/jc/page/16 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 May 2019 08:00:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>phocean | Phocean.net | Page 16</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="../../../xmlrpc.php" />
<!--[if lt IE 9]>
<script src="/wp-content/themes/twentytwelve/js/html5.js"></script>
<![endif]-->

	  <link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link href='https://fonts.gstatic.com/' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="Phocean.net &raquo; Feed" href="/feed" />
<link rel="alternate" type="application/rss+xml" title="Phocean.net &raquo; Posts by phocean Feed" href="../feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/phocean.net\/wp-includes\/js\/wp-emoji-release.min.js"}};
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/phocean.net\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-lightbox-2.min.css-css'  href='/wp-content/plugins/wp-lightbox-2/styles/lightbox.min.css?ver=1.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-fonts-css'  href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&amp;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-style-css'  href='/wp-content/themes/twentytwelve-child/style.css?ver=4.9.10' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-block-style-css'  href='/wp-content/themes/twentytwelve/css/blocks.css?ver=20181230' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js'></script>
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.9.10" />
	<style type="text/css" id="twentytwelve-header-css">
			.site-header h1 a,
		.site-header h2 {
			color: #627690;
		}
		</style>
	</head>

<body class="archive paged author author-jc author-3 paged-16 author-paged-16 full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
                        <div style="float:left">

			<a href="../../../index.html" >
			<img class="logo" src="../../../logo.svg" width="119" height="77" onerror="this.removeAttribute('onerror'); this.src='../../../logo.html'" />
			</a>

                        <!--<img src="/wp-content/themes/twentytwelve-child/logo.png" style="vertical-align:middle;"/>-->

                        </div>
                        <div style="float:left">
                        <h1 class="site-title">
                      <span><a href="../../../index.html" title="Phocean.net" rel="home">
                        Phocean.net</a></span></h1>
			<h2 class="site-description">Computer Security Blog</h2>
                </div>
		<div style="float:right;overflow:hidden;word-wrap: break-word;">
			<form role="search" method="get" id="searchform" class="searchform" action="/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>		</div>
		</hgroup>

                <div style="clear:both"></div>
		<nav id="site-navigation" class="main-navigation" role="navigation">
			<h3 class="menu-toggle">Menu</h3>
			<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
			<div class="menu-top-container"><ul id="menu-top" class="nav-menu"><li id="menu-item-1527" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1527"><a href="../../../index.html"><i class="icon-home"></i> Blog</a></li>
<li id="menu-item-1919" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1919"><a href="../../../archives.html"><i class="icon-archive"></i> Archives</a></li>
<li id="menu-item-1525" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1525"><a href="../../../tools.html"><i class="icon-beaker"></i> Code</a></li>
<li id="menu-item-1559" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1559"><a href="../../../docs.html"><i class="icon-doc"></i> Docs</a></li>
<li id="menu-item-1526" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1526"><a href="../../../about.html"><i class="icon-user"></i> About</a></li>
<li id="menu-item-1809" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1809"><a href="http://twitter.com/_phocean"><i class="icon-twitter-1"></i> Twitter</a></li>
<li id="menu-item-1810" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1810"><a href="../../../indexcc4d.html?feed=rss"><i class="icon-rss"></i> RSS</a></li>
</ul></div>		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">
	<section id="primary" class="site-content">
		<div id="content" role="main">

		
			
			<header class="archive-header">
				<h1 class="archive-title">Author Archives: <span class="vcard"><a class="url fn n" href="../../jc.html" title="phocean" rel="me">phocean</a></span></h1>
			</header><!-- .archive-header -->

			
						<nav id="nav-above" class="navigation" role="navigation">
				<h3 class="assistive-text">Post navigation</h3>
				<div class="nav-previous"><a href="17.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				<div class="nav-next"><a href="15.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
			</nav><!-- .navigation -->
			
			
										
	<article id="post-573" class="post-573 post type-post status-publish format-standard hentry category-reversing category-security tag-assembler tag-reverse-engeniering">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/12/18/removing-executable-password-protection.html" title="Permalink to Removing executable password protection" rel="bookmark">Removing executable password protection</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p>Nice demo <a title="Removing executable password protection" href="http://blog.reversinglabs.com/2009/12/exe-password-protection/">there</a>.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/reversing.html" rel="category tag">Reversing</a>, <a href="../../../category/security.html" rel="category tag">Security</a> <i class="icon-tag"></i> <a href="../../../tag/assembler.html" rel="tag">Assembler</a>, <a href="../../../tag/reverse-engeniering.html" rel="tag">Reverse Engeniering</a> <i class="icon-calendar"></i> <a href="../../../2009/12/18/removing-executable-password-protection.html" title="9:41 am" rel="bookmark"><time class="entry-date" datetime="2009-12-18T09:41:25+00:00">December 18, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->							
	<article id="post-571" class="post-571 post type-post status-publish format-standard hentry category-pentesting category-security tag-apache tag-fingerprinting tag-httprint tag-modsecurity tag-scanner tag-waf tag-waf00f">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/12/16/waf00f.html" title="Permalink to waf00f" rel="bookmark">waf00f</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p><strong>waf00f</strong> is another nice fingerprinting tool.<br />
It is a good complement to a tool like httprint. It is able to detect Web Application Firewalls.<br />
Its output can help you to determine the trust you can have in what httprint or any other web server fingerprinting tool found out.<br />
Check it <a title="waf00f" href="http://pentestit.com/2009/07/10/wafw00f-fingerprint-web-application-firewall/" target="_blank">there</a>.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/pentesting.html" rel="category tag">Pentesting</a>, <a href="../../../category/security.html" rel="category tag">Security</a> <i class="icon-tag"></i> <a href="../../../tag/apache.html" rel="tag">Apache</a>, <a href="../../../tag/fingerprinting.html" rel="tag">Fingerprinting</a>, <a href="../../../tag/httprint.html" rel="tag">httprint</a>, <a href="../../../tag/modsecurity.html" rel="tag">ModSecurity</a>, <a href="../../../tag/scanner.html" rel="tag">scanner</a>, <a href="../../../tag/waf.html" rel="tag">Waf</a>, <a href="../../../tag/waf00f.html" rel="tag">waf00f</a> <i class="icon-calendar"></i> <a href="../../../2009/12/16/waf00f.html" title="11:40 pm" rel="bookmark"><time class="entry-date" datetime="2009-12-16T23:40:09+00:00">December 16, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->							
	<article id="post-555" class="post-555 post type-post status-publish format-standard hentry category-defense category-linux category-security category-administration-systeme tag-apache tag-firewall tag-modsecurity tag-regex tag-xss">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/12/10/modsecurity-2-5-review.html" title="Permalink to ModSecurity 2.5 review" rel="bookmark">ModSecurity 2.5 review</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p>I finished reading the <strong>ModSecurity 2.5</strong> book, written by <strong>Magnus Mischell</strong> and published by <strong>Packt Publishing</strong>.</p>
<p style="text-align: center;"><a title="Modsecurity 2.5" href="http://www.packtpub.com/modsecurity-2-5/book" target="_blank"><img class="size-full wp-image-521  aligncenter" title="ModSecurity 2.5" src="../../../wp-content/uploads/2009/11/1847194745.js" /></a></p>
<p>I found a lot of interest reading it as I was already using ModSecurity &#8211; and I think anyone exposing an Apache web server should.<br />
I was actually using it partially. It is not trivial to secure a web application, and the rule engine of ModSecurity is very powerful but it is also quite complex.</p>
<p>So this book was a good opportunity for me to dig into it further.</p>
<p>The book covers all topics : from the set-up to a real use-case.<br />
The author explains how to write rules, how to deal with the performance impact, logging and gives us a range of various core rules to implement to get a good security basis.</p>
<p>The difficulty goes up progressively and the author doesn&#8217;t forget the beginners.<br />
The set-up of the module is precisely described. All requirements are also explained and there are some good recalls about regular expressions, common attacks on systems, server and client sides, and other stuff like that.</p>
<p>After reading the book, I could harden my rules, reorganize and optimize them for better performance &#8211; something I hadn&#8217;t cared about before.</p>
<p>So I have nothing else to say but to recommend this book.<br />
It is definitely <strong>a great handbook about ModSecurity</strong> that&#8217;s worth having next to you. The variety of configuration patterns makes it a reference.</p>
<p>Check it <a title="Modsecurity 2.5" href="http://www.packtpub.com/modsecurity-2-5/book" target="_blank">there</a>. I also appreciated the availability of PDF version, so that I can carry it everywhere with my laptop and index it with Beagle.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/defense.html" rel="category tag">Defense</a>, <a href="../../../category/administration-systeme/linux.html" rel="category tag">Linux</a>, <a href="../../../category/security.html" rel="category tag">Security</a>, <a href="../../../category/administration-systeme.html" rel="category tag">System</a> <i class="icon-tag"></i> <a href="../../../tag/apache.html" rel="tag">Apache</a>, <a href="../../../tag/firewall.html" rel="tag">Firewall</a>, <a href="../../../tag/modsecurity.html" rel="tag">ModSecurity</a>, <a href="../../../tag/regex.html" rel="tag">Regex</a>, <a href="../../../tag/xss.html" rel="tag">XSS</a> <i class="icon-calendar"></i> <a href="../../../2009/12/10/modsecurity-2-5-review.html" title="3:12 pm" rel="bookmark"><time class="entry-date" datetime="2009-12-10T15:12:56+00:00">December 10, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->							
	<article id="post-542" class="post-542 post type-post status-publish format-standard hentry category-defense category-linux tag-amavis tag-dovecot tag-imap tag-mta tag-opensuse tag-postifx tag-smtp tag-spam tag-spamassassin tag-umask">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/12/09/dovecot-lda-vs-procmail.html" title="Permalink to Dovecot LDA vs Procmail" rel="bookmark">Dovecot LDA vs Procmail</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p>I have a mail server configuration based on <strong>Postfix</strong> for the smtp, <strong>Dovecot</strong> for the imap and virtual users receiving e-mails in maildir boxes.</p>
<p>I am also using <strong>Amavis</strong> and <strong>Spamassassin</strong> for content filtering.</p>
<p>I am not going now to describe this configuration, I think there are already a lot of very good tutorials about it all over the web. Moreover, the openSUSE maintainers made such a configuration quite easy : a sensible part of the work just consists in commenting out some line in the configuration files.</p>
<p>However, with the basic setup, I had an issue with permissions :  all e-mails delivered by Postfix were created with permissions set to 600.</p>
<p>A typical use case with which I got into trouble was spam learning, done with a cron script with a dedicated account (&#8220;vscan&#8221;, you don&#8217;t want to execute such a script with root, right ?).</p>
<p>In that case, what I need is files to be created with permissions 660.</p>
<p>It seems easy and rather obvious at first, but actually there is not such a setting in Postfix.</p>
<p>Actually, it is not really the job of the MTA to do it, so in the case of Postfix it doesn&#8217;t bother with the transmission of such a parameter.<br />
Then, I tried to use Procmail and set UMASK in <strong>/etc/procmailrc</strong>, but this just didn&#8217;t have any effect.</p>
<p>After searching and trying in vain a couple of hours, I found out that Dovecot can also deliver e-mails from the MTA to the maildir with Dovecot LDA.</p>
<p>So I tested it out. The configuration is pretty straightforward.</p>
<p>Add the line in bold to the virtual user configuration in <strong>/etc/postfix/main.cf</strong> :</p>
<pre>[...]
virtual_mailbox_domains = domain.com
virtual_mailbox_maps = hash:/etc/postfix/vmailbox
virtual_mailbox_base = /home/vmail
virtual_minimum_uid = 100
virtual_gid_maps = static:1002
virtual_uid_maps = static:1001
virtual_transport = dovecot
[...]</pre>
<p>Now, add these lines in <strong>/etc/postfix/master.cf</strong> :</p>
<pre>[...]
# Dovecot LDA
dovecot   unix  -       n       n       -       -       pipe
   flags=DRhu user=vmail argv=/usr/lib/dovecot/deliver -d ${recipient}
[...]</pre>
<p>Finally, configure <strong>/etc/dovecot/dovecot.conf</strong> with these sections :</p>
<pre>[...]
protocol lda {
  # If you wish to use plugins you need to specify plugin directory
  # For example quota enforcing is implemented by plugin
  module_dir = /usr/lib/dovecot/modules/lda
  # Address from LDA should send MDNs like out of quota
  postmaster_address = postmaster@domain.com
  # UNIX socket path to master authentication server to find users.
  auth_socket_path = /var/run/dovecot/auth-master
}
[...]
auth default {
[...]
  socket listen {
	master {
		# Master socket provides access to userdb information. It's typically
		# used to give Dovecot's local delivery agent access to userdb so it
		# can find mailbox locations.
	      	path = /var/run/dovecot/auth-master
      		mode = 0660
		user = vmail
		group = vmail
	}
	client {
		# The client socket is generally safe to export to everyone. Typical use
		# is to export it to your SMTP server so it can do SMTP AUTH lookups
		# using it.
		path = /var/run/dovecot/auth-client
		mode = 0660
	}
  }
}
[...]</pre>
<p>And that&#8217;s all !<br />
Restart Postfix and Dovecot, check the log to ensure that everything works fine.<br />
Now all new mails should come out in the maildir folder with permissions set to 660.</p>
<p>Definitely, in my opinion, Dovecot LDA is the way to go : simple and extensible. Good bye Procmail and your cluttered configuration file.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/defense.html" rel="category tag">Defense</a>, <a href="../../../category/administration-systeme/linux.html" rel="category tag">Linux</a> <i class="icon-tag"></i> <a href="../../../tag/amavis.html" rel="tag">Amavis</a>, <a href="../../../tag/dovecot.html" rel="tag">Dovecot</a>, <a href="../../../tag/imap.html" rel="tag">IMAP</a>, <a href="../../../tag/mta.html" rel="tag">mta</a>, <a href="../../../tag/opensuse.html" rel="tag">openSUSE</a>, <a href="../../../tag/postifx.html" rel="tag">Postifx</a>, <a href="../../../tag/smtp.html" rel="tag">SMTP</a>, <a href="../../../tag/spam.html" rel="tag">Spam</a>, <a href="../../../tag/spamassassin.html" rel="tag">Spamassassin</a>, <a href="../../../tag/umask.html" rel="tag">umask</a> <i class="icon-calendar"></i> <a href="../../../2009/12/09/dovecot-lda-vs-procmail.html" title="2:10 am" rel="bookmark"><time class="entry-date" datetime="2009-12-09T02:10:17+00:00">December 9, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->							
	<article id="post-534" class="post-534 post type-post status-publish format-standard hentry category-defense category-pentesting category-security tag-nessus tag-scanner tag-security tag-vulnerability">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/12/01/nessus-4-2.html" title="Permalink to Nessus 4.2" rel="bookmark">Nessus 4.2</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p><a title="Nessus 4.2" href="http://www.nessus.org/download/" target="_blank">Nessus 4.2</a> is out.</p>
<p>I tried it out and I must say that the new UI is great. I am not a big fan of Flash and I regret this choice. However, the design is excellent, all options are accessible in a logical way. Instead of spreading over the options like it used to be, they come to you in the right order.</p>
<p>I also appreciate that the server and the client set-up are now unified thanks to the web interface (you can access it from localhost or from the network indifferently).</p>
<p>The report section has also been greatly improved.</p>
<p>So, if you were already an Nessus user, it is worth upgrading.</p>
<p>Talking about the set-up, there is an up-to-date package for openSUSE (of course, there are a lot less dependencies than before).</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/defense.html" rel="category tag">Defense</a>, <a href="../../../category/security/pentesting.html" rel="category tag">Pentesting</a>, <a href="../../../category/security.html" rel="category tag">Security</a> <i class="icon-tag"></i> <a href="../../../tag/nessus.html" rel="tag">nessus</a>, <a href="../../../tag/scanner.html" rel="tag">scanner</a>, <a href="../../../tag/security.html" rel="tag">Security</a>, <a href="../../../tag/vulnerability.html" rel="tag">Vulnerability</a> <i class="icon-calendar"></i> <a href="../../../2009/12/01/nessus-4-2.html" title="9:21 pm" rel="bookmark"><time class="entry-date" datetime="2009-12-01T21:21:23+00:00">December 1, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->							
	<article id="post-524" class="post-524 post type-post status-publish format-standard hentry category-cryptography category-linux category-security category-administration-systeme tag-apache tag-debian tag-linux tag-opensuse tag-security tag-ssl tag-vulnerability">
				<header class="entry-header">

						<h1 class="entry-title">
				<a href="../../../2009/11/28/openssl-cve-2009-3555-security-fix-and-mod_ssl-client-authentication-breakage.html" title="Permalink to OpenSSL : CVE-2009-3555 security fix and mod_ssl client authentication breakage" rel="bookmark">OpenSSL : CVE-2009-3555 security fix and mod_ssl client authentication breakage</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<!-- Adds 140x140 featured image to single post view -->
			<div class="excerpt-thumb">
							</div>
			<p>A security advisory on OpenSSL has recently been published. Details are <a title="CVE-2009-3555" href="http://secunia.com/advisories/cve_reference/CVE-2009-3555/">there</a> and <a title="renegociation vulnerability" href="http://www.securegoose.org/2009/11/tls-renegotiation-vulnerability-cve.html">there</a>.</p>
<p>It is vulnerable to a <strong>MiTM attack </strong>where the attacker can intercept and retrieve the credential to a trusted HTTPS website, by intercepting the session cookie sent back to the client.</p>
<p>A proof of concept of an attack against Twitter was made.</p>
<p>Fine. But so far, <strong>the answer was to just disable any renegociation</strong>.</p>
<p>This actually causes some issues with SSL session timeout and totally broke client authentication.</p>
<p>I got into problems because of the latter. I am using client authentication for some location of my web server, and I recently could not connect anymore to these with the following log in apache :</p>
<pre>[Tue Nov 24 16:56:15 2009] [debug] ssl_engine_kernel.c(1912): OpenSSL:Exit: error in SSLv3 read client hello A
[Tue Nov 24 16:56:15 2009] [error] [client x.x.x.x] Re-negotiation handshake failed: Not accepted by client!?</pre>
<p>I first was not aware of the openssl patch and tried almost anything possible. My focus was, of course, on the certificate and the client.<br />
But, a nice guy on IRC #suse,<strong> Stittel</strong>, had a good hunch and suggested me to look at the CVE-2009-3555 fix.</p>
<p>After more tests, it was quickly confirmed to work well with older versions of OpenSSL (as shipped in Debian Lenny).<br />
Finally, I downgraded the OpenSSL version on my openSUSE box to a version prior to the CVE-2009-3555 fix and it just worked fine.</p>
<p>Then, I dig into it and found a lot of interesting reports <a href="https://bugzilla.redhat.com/show_bug.cgi?id=533125" target="_blank">there</a> and <a href="http://old.nabble.com/TLS-renegotiation-disabling-:-mod_ssl-and-OpenSSL--0.9.8l-td26285568.html" target="_blank">there</a>. So far it is a real mess.<br />
In short, the breakage will stay as long as browsers don&#8217;t also include a patch to avoid renegotiation.<br />
So far, I could not find a browser that does include a patch.<br />
If anyone reading it knows a version that does it, please let me know.</p>
<p>Meanwhile, you have actually the choice between :</p>
<ul>
<li>low security by deactivating client authentication on your server</li>
<li>low security by keeping a vulnerable version of OpenSSL</li>
</ul>
<p>As my server is not very exposed, I chose the latter, but that&#8217;s not satisfying.  It is not recommended, but if like me you need to use client authentication with mod_ssl on openSUSE 11.2, do :</p>
<pre>% zypper install --from repo-oss openssl openssl-certs libopenssl0_9_8 libopenssl0_9_8-32bit</pre>
<p>where repo-oss is the alias to the 11.2 release (without updates) on your system.</p>
<p>What a brutal way to fix an issues without much notification and consideration to the users ! Even the log message is wrong and just confusing the administrator&#8230;</p>
<p><em>PS 1 : thanks again to Stittel for the good hint (I hope you will come by here) and to the always nice and helpful #suse channel in general ;)</em></p>
<p><em>PS 2 : <a href="https://bugzilla.novell.com/show_bug.cgi?id=558176" target="_blank">bug reported</a> on openSUSE bugzilla</em></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<i class="icon-folder-open-empty"></i> <a href="../../../category/security/cryptography.html" rel="category tag">Cryptography</a>, <a href="../../../category/administration-systeme/linux.html" rel="category tag">Linux</a>, <a href="../../../category/security.html" rel="category tag">Security</a>, <a href="../../../category/administration-systeme.html" rel="category tag">System</a> <i class="icon-tag"></i> <a href="../../../tag/apache.html" rel="tag">Apache</a>, <a href="../../../tag/debian.html" rel="tag">Debian</a>, <a href="../../../tag/linux.html" rel="tag">Linux</a>, <a href="../../../tag/opensuse.html" rel="tag">openSUSE</a>, <a href="../../../tag/security.html" rel="tag">Security</a>, <a href="../../../tag/ssl.html" rel="tag">SSL</a>, <a href="../../../tag/vulnerability.html" rel="tag">Vulnerability</a> <i class="icon-calendar"></i> <a href="../../../2009/11/28/openssl-cve-2009-3555-security-fix-and-mod_ssl-client-authentication-breakage.html" title="6:08 pm" rel="bookmark"><time class="entry-date" datetime="2009-11-28T18:08:50+00:00">November 28, 2009</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../jc.html" title="View all posts by phocean" rel="author">phocean</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->			
						<nav id="nav-below" class="navigation" role="navigation">
				<h3 class="assistive-text">Post navigation</h3>
				<div class="nav-previous"><a href="17.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				<div class="nav-next"><a href="15.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
			</nav><!-- .navigation -->
			
		
		</div><!-- #content -->
	</section><!-- #primary -->


		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
									<a href="https://wordpress.org/" class="imprint" title="Semantic Personal Publishing Platform">
				Proudly powered by WordPress			</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type='text/javascript'>
/* <![CDATA[ */
var JQLBSettings = {"fitToScreen":"1","resizeSpeed":"400","displayDownloadLink":"0","navbarOnTop":"0","loopImages":"","resizeCenter":"","marginSize":"5","linkTarget":"_self","help":"","prevLinkTitle":"previous image","nextLinkTitle":"next image","prevLinkText":"\u00ab Previous","nextLinkText":"Next \u00bb","closeTitle":"close image gallery","image":"Image ","of":" of ","download":"Download","jqlb_overlay_opacity":"80","jqlb_overlay_color":"#000000","jqlb_overlay_close":"1","jqlb_border_width":"10","jqlb_border_color":"#ffffff","jqlb_border_radius":"0","jqlb_image_info_background_transparency":"100","jqlb_image_info_bg_color":"#ffffff","jqlb_image_info_text_color":"#000000","jqlb_image_info_text_fontsize":"10","jqlb_show_text_for_image":"1","jqlb_next_image_title":"next image","jqlb_previous_image_title":"previous image","jqlb_next_button_image":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/next.gif","jqlb_previous_button_image":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/prev.gif","jqlb_maximum_width":"","jqlb_maximum_height":"","jqlb_show_close_button":"1","jqlb_close_image_title":"close image gallery","jqlb_close_image_max_heght":"22","jqlb_image_for_close_lightbox":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/closelabel.gif","jqlb_keyboard_navigation":"1","jqlb_popup_size_fix":"0"};
var JQLBSettings = {"fitToScreen":"1","resizeSpeed":"400","displayDownloadLink":"0","navbarOnTop":"0","loopImages":"","resizeCenter":"","marginSize":"5","linkTarget":"_self","help":"","prevLinkTitle":"previous image","nextLinkTitle":"next image","prevLinkText":"\u00ab Previous","nextLinkText":"Next \u00bb","closeTitle":"close image gallery","image":"Image ","of":" of ","download":"Download","jqlb_overlay_opacity":"80","jqlb_overlay_color":"#000000","jqlb_overlay_close":"1","jqlb_border_width":"10","jqlb_border_color":"#ffffff","jqlb_border_radius":"0","jqlb_image_info_background_transparency":"100","jqlb_image_info_bg_color":"#ffffff","jqlb_image_info_text_color":"#000000","jqlb_image_info_text_fontsize":"10","jqlb_show_text_for_image":"1","jqlb_next_image_title":"next image","jqlb_previous_image_title":"previous image","jqlb_next_button_image":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/next.gif","jqlb_previous_button_image":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/prev.gif","jqlb_maximum_width":"","jqlb_maximum_height":"","jqlb_show_close_button":"1","jqlb_close_image_title":"close image gallery","jqlb_close_image_max_heght":"22","jqlb_image_for_close_lightbox":"https:\/\/phocean.net\/wp-content\/plugins\/wp-lightbox-2\/styles\/images\/closelabel.gif","jqlb_keyboard_navigation":"1","jqlb_popup_size_fix":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-lightbox-2/wp-lightbox-2.min.js'></script>
<script type='text/javascript' src='/wp-content/themes/twentytwelve/js/navigation.js'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js'></script>
<!-- Generated in 1.653 seconds. Made 11 queries to database and 43 cached queries. Memory used - 27.6MB -->
<!-- Cached by DB Cache Reloaded Fix -->
</body>

<!-- Mirrored from phocean.net/author/jc/page/16 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 May 2019 08:00:48 GMT -->
<!-- Mirrored from phocean.net/author/jc/page/16 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 May 2019 08:00:48 GMT -->
</html>

<!-- Dynamic page generated in 1.620 seconds. -->