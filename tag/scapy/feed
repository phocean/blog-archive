<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Scapy &#8211; Phocean.net</title>
	<atom:link href="/blog-archive/tag/scapy/feed" rel="self" type="application/rss+xml" />
	<link>/blog-archive</link>
	<description>Computer Security Blog</description>
	<lastBuildDate>Fri, 24 Feb 2017 21:17:51 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.9.10</generator>
	<item>
		<title>Promiscuous mode detection</title>
		<link>/blog-archive/2009/06/01/promiscuous-mode-detection.html</link>
		<pubDate>Mon, 01 Jun 2009 18:46:09 +0000</pubDate>
		<dc:creator><![CDATA[phocean]]></dc:creator>
				<category><![CDATA[Defense]]></category>
		<category><![CDATA[Pentesting]]></category>
		<category><![CDATA[Security]]></category>
		<category><![CDATA[arp]]></category>
		<category><![CDATA[Fingerprinting]]></category>
		<category><![CDATA[IDS]]></category>
		<category><![CDATA[Promisc]]></category>
		<category><![CDATA[Promiscuous]]></category>
		<category><![CDATA[Scapy]]></category>
		<category><![CDATA[Sniffing]]></category>

		<guid isPermaLink="false">http://www.phocean.net/?p=375</guid>
		<description><![CDATA[Detectpromisc is a python script based on Scapy, that allows to detect if a computer is sniffing the network. By nature, it is quite difficult to detect if a machine is sniffing, because it operates passively, receiving all packets from the wire but, normaly, answering only to packets destinated to itself. There are however several...<br><i class="icon-right-hand"></i> <span class="read-more"><a href="/blog-archive/2009/06/01/promiscuous-mode-detection.html">Continue Reading</a></span>]]></description>
				<content:encoded><![CDATA[<p><a title="Detectpromisc" href="http://detectpromisc.sourceforge.net/index.html" target="_blank">Detectpromisc</a> is a python script based on Scapy, that allows to detect if a computer is sniffing the network.</p>
<p>By nature, it is quite difficult to detect if a machine is sniffing, because it operates passively, receiving all packets from the wire but, normaly, answering only to packets destinated to itself.</p>
<p>There are however several methods that make the detection possible.</p>
<p>Some are based on the latency, because in promiscuous mode a machine will take more time to answer (packets have to be processed by the kernel, not the network card only).</p>
<p>Another imply to generate some tricky packets, with a correct IP but a wrong MAC address. The machine should answer only if it is in spoofing mode.</p>
<p>It is also possible to use source-routing with a host on the path that doesn&#8217;t route. If an answer comes back anyway, the target is sniffing.</p>
<p>Other methods are implemented by IDS and based on the volume of DNS requests.</p>
<p>Most of these methods are not necessarily reliable, easy to implement. All the ones based on IP routing are quite easy to workaround by the attacker.</p>
<p>Detectpromisc works exclusively at the ARP level.</p>
<p>According to the OS, it sends out some specific ARP packets (multicast, fake broadcast&#8230;).</p>
<p>In normal mode, the network card will discard theses illegitimate packets : they call it the hardware filter.<br />
In promiscuous mode, there is no hardware filter : packets reaches directly the kernel (software filter).</p>
<p>Of course, according to the OS, the kernel will behave differently, but some tricked ARP packets generated by Detectpromisc will cause the sniffing machine to send an answer.</p>
<p>It is therefore possible to differenciate a sniffing machine from a normal machine. Plus, as it is quite reliable and OS specific, it is possible to fingerprint the target.</p>
<p>In practice, it has worked very well so far :</p>
<pre>% sudo ./detect.py -i eth0 -O 192.168.222.25
Scan right index finger on UPEK TouchStrip
WARNING: No route found for IPv6 destination :: (no default route?)
192.168.222.25 : promiscuous mode card detected
probably: Linux 2.2/2.4/2.6
% sudo ./detect.py -i eth0 -O 192.168.222.26
WARNING: No route found for IPv6 destination :: (no default route?)
192.168.222.26 : promiscuous mode card detected
probably: Windows 2k/NT4</pre>
<p>A full paper on how it works is <a title="ARP based sniffing detection" href="http://www.securityfriday.com/promiscuous_detection_01.pdf" target="_blank">there</a>. Great tool, isn&#8217;t it ?</p>
]]></content:encoded>
			</item>
	</channel>
</rss>
